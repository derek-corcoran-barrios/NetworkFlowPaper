---
title: "Target-based site prioritization under climate change using quadratic network flow"
author: "Derek Corcoran"
output:
  bookdown::pdf_document2:
    citation_package: none
    pandoc_args: ["--csl", "methods-in-ecology-and-evolution.csl"]
    keep_tex: true
    fig_caption: true
    toc: false
bibliography: test.bib
biblio-style: methods-in-ecology-and-evolution
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(bookdown)
library(kableExtra)
library(knitr)
library(raster)
library(rasterVis)
library(rworldxtra)
library(sf)
library(tidyverse)
RasterSolsnandes <- readRDS("RasterSolsnandes.rds")
```

# Introduction

Currently, 14.9% of terrestrial area is a part of the global protected area network [@unep2018ngs]. However, most of this areas have not been created using priorization tools developed to maximize species or ecosystems conservation based on current biodiversity patterns [@rodrigues2004effectiveness; @jenkins2015us]. The situation is even worst when we take into account that the range of species will change over time [@araujo2004would; @chen2011rapid; @lenoir2008significant; @regos2016predicting], were several species that are now being protected by these areas might not be protected in the future because of the climate crisis [@alagador2014shifting; @araujo2004would].

Despite the concern about protected area planning, a review @jones2016incorporating shows that more than 90% of the prioritization planing studies that try to incorporate climate change, only take two time steps into account, current climate and the last step of climate. Currently, two of the most used tools for conservation planning are Prioritize and Zonation [@di2014quick; @Hanson2019]. Zonation can be used for conservation prioritization under climate change as conservation features may be explicitly linked through interaction. This allows for simultaneous prioritization of a species current range, its modelled future range, and the connectivity between the two limited by a species’ capacity to disperse.  

```{r}
DF <- data.frame(BLA = c("Considers more than 2 time-slices", "Can add species to the solutions afterwards", "Keep track of species dispersal routes", "Solves for conservation targets", "Considers cost as part of the solution"), Network_Flow = rep("Yes", 5), Zonation = c("No", "No", "Yes", "Yes", "Yes"), Migclim = c("Yes", "Yes", "Yes", "No", "No"), Prioritizr = c("No", "No", "No", "Yes", "Yes"))

colnames(DF) <- c("", "Network flow", "Zonation", "Migclim", "Prioritizr")

kable(DF, "latex", booktabs = T) %>% kable_styling()
```


However, in order for the species to move from areas were they are currently protected to the future protected areas, their route has to be protected as well, that is the biological corridors that they will use [@nunez2013connectivity; @rosenberg1997biological]. Thus, the planification and creation of those biological corridors correspond to adaptive measures to environmental changes that would mitigate the impacts of the climate crisis [@hannah2007protected]. In that context, biological corridors should consider effects of climate crisis, changes in land use and habitat fragmentation, in order to evaluate the factibility of the species reaching future available habitat.

There have been several approaches trying to model biological corridors. Local approaches have focus just in one or a few species [@alagador2014shifting; @cushman2013biological; @gregory2014forecasts] or group of species  [@beier2007linkage; @phillips2008optimizing; @williams2005planning], not being able to be use for planning for lack of species or be in confined spaces, respectively. A continental approach was made by @lawler2013projected, who modelled biological corridors in the Americas. Even when that model was made for close to 3,000 species did not consider species dispersal speed or use the information to build priority areas. Among these articles, the work of @phillips2008optimizing, incorporates the use of the Network Flow optimization method [@Ahuja93] in order to solve the problem expressed by @williams2005planning, generating a solution 33% more efficient than previous optimization methods. This makes this methodology one of the most promising ways of solving conservation planning problems through the use of biological corridors.

In its traditional use, Network flow gives the best possible solution given constrains [@phillips2008optimizing]. If we looked at the solution for a species in a raster, every cell would have a value of either one or zero, where one would be a cell necessary for the conservation of the species or a zero if it is not necessary. This best solution, however, only represents one of the possible solutions to conserve a species, and does not give us any alternatives. in this research we present Quadratic Cost Network Flow as alternative solution, where for every species we would still get a value of one if the cell is irreplaceable for the solution, zero if that cell is not needed, and an intermediate value for cells that are one of many alternative solutions for a given species, this is, for every cell we have an irreplaceability index. Spatial planning is a complex endeavour where agendas and/or needs evolve rapidly and several alternative suboptimal solutions might be needed in order to navigate this complex decisions.

In this article we present a new method of working with network flow on conservation planning using quadratic costs, while at the same time comparing its results and implications with traditional network flow and zonation,  using the Northern Tropical Andes ecorregion as an example.

# Methods

## Area

The studied area was the Northern Tropical Andes, consisting of the countries of Colombia, Venezuela and Ecuador, with a buffer of 200 kilometres around land areas. 

```{r MapArea, cache=TRUE, fig.align='center', fig.cap='Map of Southamerica, the darkened area is the area where the priorization was performed'}
data("countriesHigh")
SA <- st_as_sf(countriesHigh) %>% st_crop(xmin = -91.40638889, ymin = -58.09166667, xmax = -30.93750000, ymax = 12.63611111)  %>% dplyr::filter(REGION == "South America and the Caribbean") %>% st_transform("+proj=stere +lat_0=-22.720833333333335 +lon_0=-61.17194444444445")
sandes <- sf::read_sf("nandes_buff_clip/nandes_buff_clip.shp") %>% st_transform("+proj=stere +lat_0=-22.720833333333335 +lon_0=-61.17194444444445")

ggplot() + geom_sf(data = SA, fill = "darkolivegreen3", color = "white") + geom_sf(data = sandes, fill = "darkgreen", alpha = 0.5) + theme(
  panel.background = element_rect(fill = "#BFD5E3", colour = "#6D9EC1",
                                size = 2, linetype = "solid"),
  panel.grid.major = element_line(size = 0.5, linetype = 'solid',
                                colour = "white"), 
  panel.grid.minor = element_line(size = 0.25, linetype = 'solid',
                                 colour = "white")
  )


```

The studied area is shown in figure \@ref(fig:MapArea) and it encompasses `r  prettyNum(round(as.numeric(st_area(sandes))/1000000,0), big.mark = ",")` square kilometres.

## Global circulation models


```{r Diagrama, fig.cap= "All the steps and programs used in the Optimization"}
knitr::include_graphics("Diag1.png", dpi = 200)
```

Global Circulation Models (GCMs) are predictive models that use fluid models...
In this study, four GCM models were selected to project species distribution using the GCMcompareR shiny app [@fajardo_javier_2018_2669407], we followed the story-lines approach [@zappa2017storylines] and selected a GCM warmer and wetter, warmer and dryer, colder and wetter, and colder and dryer than the ensemble. The selected models where `r names(RasterSolsnandes)` all the process is shown in in figure \@ref(fig:Diagrama).

## Species selection

671 species of plants and vertebrates were used for the model, only endemic species were used in this study. A list can be found in the supplementary materials. The presences for plants and vertebrates were gather using different databases and methodologies.

For plants, all presences were collected from the BIEN database. The BIEN database is a product of a workflow of several tools, including two softwares: Taxonomic Name Resolution Service [@boyle2013taxonomic] and Geographic Name Resolution Service [@Boyle2019GNRS]. The first resolves and corrects sinonymous taxa. The second validates, eliminates or flags coordinates accordingly. In this research, only records where the scientific name was clear to the species level, passed all geographic validations, was certain to be a native species, and was not part of a plot were included.

Vertebrates ocurrences were extracted form GBIF, Vertnet, and Global Restricted range bird species data bases. We only used presences from 1950 onwards, that were recorded by human observation. All centroids and longitudes or latitudes of exactly zero were removed. Points were also removed if they were further than 500 Km from the ranges developed by IUCN.

<!-- Point occurrences for global restricted range bird species (61). Point occurrences for tropical vertebrates (GBIF, VertNet). Occurrences with geovalid coordinates. Occurrences more recent than 1950. Human observations only (no fossil records or museum specimens). Political centroids and locations with zeros removed. Spatial outliers – more than 500km from IUCN range polygon or >98th percentile of latitude + longitude. Expert range maps polygons for all available mammals, birds, reptiles were used as a means of model and occurrence record validation (61-62) -->

## Species Distribution Models. 

The Dismo Package [@Hijmans_Dismo] was used to generate Species Distribution Models with the Maxent algorithm [@phillips2006maximum; @merow2013practical]. We used the specifications recomended by @merow2013practical and @merow2014we to generate models with less overfitting and with less complex responses to variables. 
For the backround points we used 50,000 points within a polygon which encompassed all presences plus a 500 Km buffer. We used five replications of models for each species and used 30% of the presences to test the model.

Environmental Predictor Variables. The following bioclimatic variables from downscaled 20-year normals (66) based on pan-tropical correlation analysis and ability to describe the climate for a given location. 

hightly correlated variables (over xx% ) 

When presented with the choice of two variables that were otherwise closely correlated, we selected the variable that were not combinations of temperature and precipitation or relied on monthly segmentation of the yearly climate (e.g. precipitation in the warmest quarter).

* Mean annual temperature (BIO1)
* Mean diurnal temperature range (BIO2) 
* Seasonality of temperature (BIO4)
* Minimum temperature of the coldest month (BIO6)
* Mean annual precipitation (BIO12)
* Seasonality of precipitation (BIO15)

Accumulated Aridity Index. To account for the effect of dry season length and the water deficit experienced by vegetation during dry periods we derived and accumulated aridity index that identifies the maximum duration and accumulated water deficit for consecutive months where potential evapotranspiration exceeds mean monthly precipitation. The accumulated aridity index is the sum of the month aridity (precipitation – PET) for the maximum run of consecutive months where (PET > precipitation).

Soils Variables. The following soils variables were also used in species distribution models.  All variables were obtained from Soilgrids [@de2018soilgrids].  Variables with multiple strata available are the mean of the top 1m (strata 1-4).

* depth to bedrock
* pH 
* clay proportion     
* silt proportion 
* bulk density 

## Cost layer

We used a 2.5 minutes downscaled version of @naidoo2007global layer of costs in order to estimate the cost per hectare for each area, and then we modified that layer using the World Database on Protected Areas (WDPA) [@unep2018ngs], and land-cover [@tuanmu2014global]. If a cell of the cost layer was inside a proteced area, this was multiplied by zero, and if it was outside of a protected area it was multiplied by one, we only considered Protected areas of classes I and II of (WDPA). The reason for doing that is that if we are doing an excercise of prioritizing areas to be inluded in the global network of protected area, a cell that is already part of it has a cost of zero to be included in the network. On the other hand there are different costs of adding other cells to the same network. Furthermore, every cell that had over 50% of urbanization or agriculture acording to @tuanmu2014global was taken out of the possible solutions, this is because areas that are heavily urbanized or intesely used for agriculture might not be suitable for protection, and thus were taken away from the cells in possible solutions.

## Prioritization algorithms

### Network Flow

This model was developed based on the notion of non-overlapping dispersal chains [@williams2005planning], we will use two aproaches for this, the linear and quadratic Network Flow. For each species linear network flow will generate areas to be protected Values of one and cells not to be protected (values of zero). Quadratic network flow, on the other hand, will have, for each cell, an irreplaceability index going from zero to one. Here, zero means that there are no chains passing by that spacial point that go from the source to the final destination, and one is a point where chains have to pass through to reach the desired flow.
In order to do this, we follow Network-flow methods [@Ahuja93] to model the survival and dispersion of species along the space and time, using species distribution models and quadratic flow costs to split the flow evenly across alternative paths. Therefore, the resulting flow across an arc is high only if there are few alternatives to use that edge to achieve the target flow.
Even when model takes into account protected areas (cost zero) and human habitat such as cities (cost infinite) in the decision making, both were not included in this exercise to simplify the examples. This is a generalist model which only needs the distribution model of the species projected to each time slice and the maximum dispersal distance for each species.

#### Model Formulation

The objective is to minimize the cost

$\underset{Quadcost}{\text{minimize}}$

$$\small Quadcost =  \sum_{i=1}^n{(Cost\times Flow_t)^2}$$

$\text{subject to}$

$$\small \text{Initial Flow} = \sum_{i=1}^n{Flow_{t_1}} = \text{Target paths}$$

$$\small \text{Final Flow} = \sum_{i=1}^n{Flow_{t_{final}}} = \text{Target paths}$$

$$\small \text{Flow capacity} = \sum_{i=1}^n{Flow_{(i,t)}} \leq capacity_{(i,t)}$$


### Network generation

In order to generate the networks de QuadCostAmpl package was used [@Corcoran_Quadcost]


#### Linear Network Flow

Model

#### Quadratic Network Flow

### Zonation



Prioritization under Climate Change. Zonation Conservation Planning Software is a widely used tool that allows for simultaneous prioritization of many thousands of conservation features (i.e. species or ecosystem types) while also considering fundamental aspects of the landscape including habitat condition, connectivity, and cost (68-69).  Zonation can be used for conservation prioritization under climate change as conservation features may be explicitly linked through interaction.  This allows for simultaneous prioritization of a species current range, its modeled future range, and the connectivity between the two limited by a species’ capacity to disperse.  The protocol for running Zonation under uncertain climate change projections is thoroughly described in Kujala et al. 2013 (70).

Species current ranges were linked to projected future ranges through an interaction layer. This layer is transformed by a dispersal kernel with a parameter to limit the interaction to the species total capacity to disperse over the period of analysis. Total dispersal capacity was assumed to be 100km for vertebrates (roughly 1 km/yr) and 1km for vascular plants (roughly 100m/yr). The algorithm favors areas of the species range in baseline climate that are retained in the projected future climate (i.e. the areas are suitable for species in both baseline and future climate). Prioritization were conducted using the mean projected future species ranges across 10 GCM under the same RCP (RCP2.6 or RCP8.5) that were discounted by the standard deviation the projected ranges.  Prioritizations were also run for each GCM individually for both RCP2.6 and RCP8.5

Conservation Features. All available species models (vascular plants and vertebrates) were used in continental scale prioritizations.  Prioritization used the continuous value output of species distribution models for current climates and projected future climates. See species distribution modeling section above for more information. Models were fit at 30 arc-second resolution and were projected into 5km resolution environmental layers. All available species models (vascular plants and vertebrates) were used in continental scale prioritizations.  Species with too few occurrence records to produce a model were included as point locations (Zonation term = “Species of Special Interest”). Equal weighting was used for all conservation features.

### Prioritization Methods. 

Zonation ranks all cells in a landscape according to their value and removes cells of lowest value at each processing step.  Values are then recalculated for all remaining cells at each step. Core area zonation removal algorithm was used this assigns value to a cell from the highest value species present in that cell at each step of removal.  Species with smaller ranges have few cells that are critical for their conservation these cells therefore tend to have high values. By contrast, wide ranging species have more opportunities to be conserved -- so are typically lower value until only the core range remains. Warp factor (number of cells removed at each step) for all analysis was set to 1 to maximize the accuracy of the rank order assigned. All prioritizations used edge removal and boundary length penalty of 1.

## Comparizon of prioritization methods

### Spearman correlation

We used pairwise Spearman correlation in order to compare the ranking of the cells between the different prioritization methods raster results [@zar1972significance].

### Local Spearman correlation

We also tested for local correlation Spearman correlation, 

### 10% comparison

# Results {-}


```{r}
RasterSolnandes <- readRDS("RasterSolnandes.rds")
RasterSolnandes <- RasterSolnandes/cellStats(RasterSolnandes, "max")
MaskFull <- RasterSolnandes
values(MaskFull) <- ifelse(is.na(values(MaskFull)), NA, 1)
```


```{r}
RasterSolnandes_ln <- readRDS("RasterSolnandes_linear.rds")
RasterSolnandes_ln <- RasterSolnandes_ln/cellStats(RasterSolnandes_ln, "max")
```


```{r}
Zonation1 <- raster("nandes_endemic_rcp85_PA_cc.CAZ_MEBLP1000.wrscr.compressed.tif")
Zonation1 <- Zonation1/cellStats(Zonation1, "max")

MASK <- Zonation1 

values(MASK) <- ifelse(is.na(values(MASK)), NA, 1)

MASK2 <- RasterSolnandes 

values(MASK2) <- ifelse(is.na(values(RasterSolnandes)), NA, 1)


#Zonation2 <- raster("nandes_endemic_rcp85_PA_cc.CAZ_MEBLP1000.rank.compressed.tif")
#Zonation2 <- Zonation2/cellStats(Zonation2, "max")

Sols <- stack(RasterSolnandes, RasterSolnandes_ln, Zonation1)

Sols <- Sols*MASK*MASK2

names(Sols) <- c("Quadratic NF", "Linear NF", "Zonation")

myTheme <- BuRdTheme()
myTheme$panel.background$col = 'gray'
```

```{r AllSols, dev='png', dpi=700, fig.cap= "Coninuous results of the three algorithms, the highest the value the higher the priority, all values go from 0 to 1."}
levelplot(Sols, par.settings = myTheme)
```

```{r}
Sols2 <- Sols
values(Sols2) <- ifelse(is.na(values(Sols2)), 0, values(Sols2))
Sols2 <- Sols2*MaskFull
Quants <- raster::quantile(Sols2, probs = c(0.85))

values(Sols2[[1]]) <- ifelse(values(Sols2[[1]]) > Quants[1,1], 1, 0)
values(Sols2[[2]]) <- ifelse(values(Sols2[[2]]) > Quants[2,1], 1, 0)
values(Sols2[[3]]) <- ifelse(values(Sols2[[3]]) > Quants[3,1], 1, 0)
names(Sols2) <- c("Quadratic NF", "Linear NF", "Zonation")

Areas <- cellStats((Sols2*area(Sols2[[1]])), "sum")

AreaCells <- cellStats(Sols2, "sum")

r <- sum(Sols2)

rsome <- r
values(rsome) <- ifelse(is.na(values(rsome)), NA, ifelse(values(rsome) > 0, 1, 0))
Some <- cellStats(rsome, "sum")

rOne <- r
values(rOne) <- ifelse(is.na(values(rOne)), NA, ifelse(values(rOne) == 1, 1, 0))
One <- cellStats(rOne, "sum")

rTwo <- r
values(rTwo) <- ifelse(is.na(values(rTwo)), NA, ifelse(values(rTwo) == 2, 1, 0))
Two <- cellStats(rTwo, "sum")

rThree <- r
values(rThree) <- ifelse(is.na(values(rThree)), NA, ifelse(values(rThree) == 3, 1, 0))
Three <- cellStats(rThree, "sum")
```


```{r}
COR <- as.data.frame(Sols) %>% dplyr::filter(!is.na(Zonation), !is.na(Quadratic.NF))
```


* **For methods:** Since one of the main objectives of priorization methods is to rank the cells within an area, we used Spearman's rho correlation, that estimates the rank-based measure of association. We also calculated a local Spearman correlation on a matrix of five by five cells, in order to figure out if there are some important 


There are two ways of trying to look at the results, as a continuous layer, as in figure \@ref(fig:AllSols), or as a binary solution as in fig \@ref(fig:Binary), where the cells in red are the top 10% ranked cells to be protected. At first glance, the three algorithms have very similar results. In all three methods the Andes mountains appear to have the highest priorities in particular the Northwest Andean montane forests, Eastern Cordillera Real montane forests, Venezuelan Andes montane forests, Cordillera Oriental montane forests, and the Cauca and Magdalena Valley montane forests, outside of the Andes mountains the ecorregions that have the highest priorities are Guianan Highlands moist forests, Pantepui forests & shrub-lands and Cordillera La Costa montane forests. Furthermore, when we look at the top 10% cells selected by the algorithms (Figures \@ref(fig:Binary) and  \@ref(fig:NumberOfTimes)), we see that of all the cells that were selected at least by one algorithm, `r paste0(round((Three/Some*100),2), "%")` of them were selected by all three algorithms, which show the level of concordance between cells, `r paste0(round((Two/Some*100),2), "%")` were selected by two of the algorithms and only `r paste0(round((One/Some*100),2), "%")` of the cells selected were chosen by only one of the methods.

However, when we look at the Spearman correlation (table \@ref(tab:Corr)), of all three methods we start seeing some important differences, where Quadratic and Linear Network flow have a spearman correlation of 0.92, but both methods have a lower correlation with zonation, with Quadratic Network Flow having a higher correlation of 0.669, vs linear network flow having a correlation of 0.624 with Zonation, all these relationships are significative. When we look at the local correlation plots (figure \@ref(fig:LocalCorr)), we see that for the most part, the local correlations are all mostly positive, specially between both Network Flow algorithms. There are some blue areas in the figure, when comparing those priorities with zonation. Representing some big discrepancies in local prioritization, that is mostly localized 


when we look at the box-plot of local correlation values (figure \@ref(fig:Boxplot)), we see that the lower whiskers in the comparison of both Network Flow methods with Zonation, are bellow zero

* **For discussion:** One of the main problems at comparing Network Flow vs Zonation, is that Zonation will give a rank to each and every cell in the study area, which is not true for Network Flow. It comes as no surprise that Quadratic Network flow has a higher correlation with Zonation than Linear Network flow, the intended result of quadratic network flow being more similar to zonation than linear network flow. 

### Efficiency comparison (Number of cells)



```{r  Binary, dev='png', dpi=700, fig.cap= "Binary solution for the cells with the top 10% value of ranked priority"}
levelplot(Sols2, par.settings = myTheme)
```

In this example when we calculate the top 10% of protected cells for Quadratic Network Flow we get `r prettyNum(round(AreaCells[1]), big.mark = ",")` cells, `r prettyNum(round(AreaCells[2]), big.mark = ",")` cells for linear Network Flow, and `r prettyNum(round(AreaCells[3]), big.mark = ",")` cells for Zonation.

```{r}
r <- ratify(sum(Sols2))

rat <- levels(r)[[1]]
rat$landcover <- c("Zero",'One', 'Two', 'Three')
rat$class <- c("0",'A1', 'B2', 'C3')
levels(r) <- rat
```

```{r NumberOfTimes, dev='png', dpi=700, fig.cap= "This map shows how many algorithms selected each cell"}
levelplot(r, col.regions=c("#0571b0","#92c5de","#f4a582","#ca0020"), colorkey = list(title = "Number of algorithms"))
```




### Correlation comparison (Spearman)

```{r Corr}
library(corrr)
COR <- as.data.frame(Sols) %>% dplyr::filter(!is.na(Zonation), !is.na(Quadratic.NF)) %>% correlate(use ="pairwise.complete.obs", method = "spearman") %>% rearrange()

kable(COR, "latex", booktabs = T, caption = "Spearman correlation between the rank of the cells of all three methods") %>% kable_styling()
```


```{r}
CORRSTACK <- read_rds("CORRSTACK.rds")
```


```{r LocalCorr, dev='png', dpi=700, fig.cap="Box plot of local correlations between all three different methods of priorization"}

levelplot(CORRSTACK, par.settings = myTheme, layout=c(3, 3))
```

```{r Boxplot, fig.cap="Box plot of local correlations between all three different methods of priorization"}
bwplot(CORRSTACK[[c(2,3,6)]], violin = FALSE)
```


# Discussion

## Primer parrafo (Comparison to other methods, begin by revisiting the methodology, you can use similar language or even similar sentences this is supposet to be an echo to prior sentences)

In this study we compared the solution of Quadratic Cost Network Flow, Linear Cost Network Flow and Zonation in order to solve for the conservation of 671 species of Plants and Vertebrates and compared the results of those solutions.

## segundo parrafo 

### 2 

Other methods for Systematic Conservation Prioritization have either used just a few species, been limited to an area smaller than a country, not dealt with climate change, or only used the present and one future layer in order to solve this priorization problems, this last point might lead to connectivity problems.

### 3 (State how this study improves on this or how it fills those gaps)

In this study, we solved a problem for 671 species, in an area of `r prettyNum(as.numeric(st_area(sandes))/1000000, big.mark = ",")` $Km^2$ encompasing three countries and a buffer zone within their neighbouring countries. We used 8 decadal time-slices in order to ensure that the species can move form one conservation area to the ones in the future. We also compared between different methods using Spearman correlation

## Tercer parrafo

### 4

In all three algorithms (Linear Network Flow, Quadratic Network Flow, and Zonation) have a high level of concordance in terms of which areas are important as shown by figures \@ref(fig:AllSols), \@ref(fig:Binary) and  \@ref(fig:NumberOfTimes)

### 5

Shows how results enhances prior studies

### 6

Highlights some results of the study on it's own

### 7

Concludes on those results

## Cuarto parrafo

### 8

Highlight the general study

### 9

Highlights the application

### 10

States that there might be some limitations

## Quinto parrafo

### 11

Shows a general limitation of the research

### 12

States gaps of this research

# Acknowledgments {-}

Funding:

# Supplemental Data 

Supplementary Material should be uploaded separately on submission, if there are
Supplementary Figures, please include the caption in the same file as the
figure. LaTeX Supplementary Material templates can be found in the Frontiers
LaTeX folder

# References

# Figures {-}


# Suplmentary materials

## List of species

```{r Species_list ,cache=TRUE}
a <- readRDS("Solutionnandes_linear_mp.rds") %>% purrr::reduce(bind_rows) %>% group_by(Spp) %>% summarise(n = n()) %>% arrange(Spp) %>% pull(Spp) %>% str_replace("_", " ")
```

The species used for the solution were the folowing:

`r a`